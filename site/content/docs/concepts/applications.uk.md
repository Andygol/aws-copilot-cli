---
title: Застосунки
---

# Застосунки

Застосунок — це група повʼязаних сервісів, середовищ та конвеєрів. Незалежно від того, чи ви маєте один сервіс, який робить усе, чи набір мікросервісів, Copilot організовує сервіс(и) та середовища, у які вони можуть бути розгорнуті, у "застосунок".

Розгляньмо приклад. Ми хочемо створити застосунок для голосування, який повинен збирати голоси та агрегувати результати.

Щоб налаштувати наш застосунок для голосування з двома сервісами, ми можемо двічі запустити `copilot init`. Перший раз, коли ми запускаємо `copilot init`, він запитає, як ми хочемо назвати застосунок, до якого належатиме цей сервіс. Оскільки ми намагаємося створити систему голосування, ми можемо назвати наш застосунок "vote" і наш перший сервіс "collector". Наступного разу, коли ми запустимо `init`, нас запитають, чи хочемо ми додати наш новий сервіс до наявного застосунку "vote", і ми назвемо новий сервіс "aggregator".

Конфігурація вашого застосунку (сервіси та середовища які до нього належать) зберігається у вашому обліковому записі AWS, тому будь-які інші користувачі у вашому обліковому записі зможуть брати участь в розробці застосунку "vote". Це означає, що ваш колега може працювати над одним сервісом, поки ви розробляєте інший.

![](https://user-images.githubusercontent.com/879348/85869625-cd858d00-b780-11ea-817c-638814049d2d.png)

## Створення застосунку

!!! Attention "Увага"
    Якщо у вас вже є тека `copilot/`, створена для інших цілей, ви можете виявити, що Copilot створює файли в цій теці. Якщо це станеться, ви можете створити порожню теку з назвою `copilot/` поруч з вашою робочою текою. Copilot використовуватиме цю порожню теку.

Щоб налаштувати застосунок, ви можете просто запустити `copilot init`. Вас запитають, чи хочете ви налаштувати новий застосунок або вибрати наявний.

```bash
copilot init
```

Після створення застосунку Copilot зберігає цей застосунок у SSM Parameter store у вашому обліковому записі AWS. Обліковий запис, який використовується для налаштування вашого застосунку, відомий як "обліковий запис застосунку". Тут зберігається конфігурація вашого застосунку, і будь-хто, хто має доступ до цього облікового запису, може використовувати цей застосунок.

Усі ресурси, створені в межах цього застосунку, будуть позначені теґом `copilot-app` [теґ ресурсу aws](https://docs.aws.amazon.com/general/latest/gr/aws_tagging.html). Це допомагає вам знати, які ресурси застосунку у вашому обліковому записі належать до нього.

Назва вашого застосунку має бути унікальною у вашому обліковому записі (навіть у різних регіонах).

### Додаткові конфігурації застосунку

Ви також можете надати більш детальну конфігурацію для вашого застосунку, запустивши `copilot app init`. Це включає опції для:

* Позначення всіх ресурсів застосунку, сервісу та середовища додатковим набором [теґів ресурсу aws](https://docs.aws.amazon.com/general/latest/gr/aws_tagging.html)
* Використання власного доменного імені для сервісів з балансуванням навантаження
* Передача поточної політики IAM для встановлення межі дозволів для всіх ролей, створених у межах застосунку.

```bash
copilot app init                                  \
  --domain my-awesome-app.aws                     \
  --resource-tags department=MyDept,team=MyTeam   \
  --permissions-boundary my-pb-policy
```

## Інфраструктура застосунку

Хоча основна частина інфраструктури, яку надає Copilot, є специфічною для середовища та сервісу, існують також деякі ресурси, що охоплюють весь застосунок.

![](https://user-images.githubusercontent.com/879348/85869637-d0807d80-b780-11ea-8359-6d75933c562a.png)

### Репозиторії ECR

Репозиторії ECR є регіональними ресурсами, які зберігають образи ваших сервісів. Кожен сервіс має свій власний репозиторій ECR для кожного регіону у вашому застосунку.

На діаграмі вище застосунок має кілька середовищ, розподілених по трьох регіонах. Кожен з цих регіонів має свій власний репозиторій ECR для кожного сервісу у вашому застосунку. У цьому випадку є три сервіси.

Кожного разу, коли ви додаєте сервіс, ми створюємо репозиторій ECR у кожному регіоні. Ми робимо це для підтримки ізоляції регіонів (якщо один регіон виходить з ладу, середовища в інших регіонах не будуть порушені) і для зменшення витрат на передачу даних між регіонами.

Ці репозиторії ECR знаходяться у вашому обліковому записі застосунку (а не в облікових записах середовищ) і мають політики, які дозволяють вашим обліковим записам середовищ отримувати з них дані.

### Інфраструктура випуску

Для кожного регіону, представленого у вашому застосунку, ми створюємо ключ KMS та кошик S3. Ці ресурси використовуються CodePipeline для забезпечення розгортання між регіонами та обліковими записами. Усі конвеєри у вашому застосунку використовують ці самі ресурси.

Подібно до репозиторіїв ECR, кошик S3 та ключі KMS мають політики, які дозволяють усім вашим середовищам, навіть в інших облікових записах, читати зашифровані артефакти розгортання. Це робить можливими ваші конвеєри CodePipeline між обліковими записами та регіонами.

## Дослідження вашого застосунку

Тепер, коли ми налаштували застосунок, ми можемо перевірити його за допомогою Copilot. Нижче наведено кілька поширених способів перевірки вашого застосунку.

### Які застосунки є у моєму обліковому записі?

Щоб побачити всі застосунки у вашому поточному обліковому записі та регіоні, ви можете запустити `copilot app ls`.

```bash
copilot app ls
vote
ecs-kudos
```

### Що є у моєму застосунку?

Запуск `copilot app show` покаже вам короткий опис вашого застосунку, включно з усіма сервісами та середовищами у вашому застосунку.

```console
copilot app show
About

  Name              vote
  Version           v1.1.0
  URI               vote-app.aws

Environments

  Name              AccountID           Region
  ----              ---------           ------
  test              000000000000        us-east-1

Workloads

  Name              Type                        Environments
  ----              ----                        ------------
  collector         Load Balanced Web Service   prod
  aggregator        Backend Service             test, prod

Pipelines

  Name
  ----
```
